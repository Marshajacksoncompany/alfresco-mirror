<?xml version='1.0' encoding='UTF-8'?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:crypt="http://code.google.com/p/spring-crypto-utils/schema/crypt"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://code.google.com/p/spring-crypto-utils/schema/crypt
        http://code.google.com/p/spring-crypto-utils/schema/crypt.xsd">

    <bean id="springKeyStoreLoader" class="org.alfresco.encryption.SpringKeyStoreLoader">
    </bean>

    <!-- Beans to initilize encryption -->
    <bean id="keyProvider" class="org.alfresco.encryption.KeystoreKeyProvider" init-method="init">
       <property name="location" value="${encryption.keystore.location}"/>
       <property name="keyStoreLoader" ref="springKeyStoreLoader"/>
       <property name="provider" value="${encryption.keystore.provider}"/>
       <property name="type"     value="${encryption.keystore.type}"/>
       <property name="passwords">
           <map>
               <entry key="keystore" value="${encryption.keystore.password}"></entry>
               <entry key="metadata" value="${encryption.keystore.password.metadata}"></entry>
               <entry key="solr" value="${encryption.keystore.password.solr}"></entry>
           </map>
       </property>
    </bean>
    
    <bean id="encryptor" class="org.alfresco.encryption.DefaultEncryptor" init-method="init">
        <property name="keyProvider" ref="keyProvider"/>
        <property name="cipherAlgorithm" value="${encryption.encryption.cipherAlgorithm}" />
    </bean>

    <bean id="macUtils" class="org.alfresco.encryption.MACUtils">
        <property name="keyProvider" ref="keyProvider"/>
        <property name="macAlgorithm" value="${encryption.macAlgorithm}"/>
    </bean>

    <bean id="encryptionUtils" class="org.alfresco.encryption.DefaultEncryptionUtils">
        <property name="encryptor" ref="encryptor"/>
        <property name="macUtils" ref="macUtils"/>
        <property name="messageTimeout" value="${encryption.messageTimeout}"/>
        <property name="remoteIP" value="${solr.solrHost}" />
    </bean>

</beans>
