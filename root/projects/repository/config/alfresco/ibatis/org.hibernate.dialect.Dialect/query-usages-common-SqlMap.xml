<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<!--
    Queries related to repository usages and restrictions.
-->
<sqlMap namespace="alfresco.query.usages">

    <!--                -->
    <!-- Type Defs      -->
    <!--                -->
    
    <typeAlias alias="Ids" type="org.alfresco.ibatis.IdsEntity"/>
    
    <!--                -->
    <!-- Statements     -->
    <!--                -->
    
    <select id="select_CountPersonsNotDisabled" parameterClass="Ids" resultClass="Long">
        <![CDATA[
        select count(*)
        from
            alf_node n
            left join alf_node_aspects na on (na.node_id = n.id and na.qname_id = #idOne#)
        where
            n.type_qname_id = #idTwo#
            and na.qname_id is null
        ]]>
    </select>

    <select id="select_CountDocuments" parameterClass="Ids" resultClass="Long">
        select count(*) from alf_node n
        where n.type_qname_id in
            <iterate property="ids" open="(" close=")" conjunction=",">#ids[]#</iterate>
    </select>

</sqlMap>