<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>
   <bean id="publishingService_dictionaryBootstrap" parent="dictionaryModelBootstrap" depends-on="dictionaryBootstrap">
        <property name="models">
            <list>
                <value>alfresco/model/publishingModel.xml</value>
            </list>
        </property>
    </bean>

   <!-- Bootstrap the publishing process definition -->
    <bean parent="workflowDeployer">
        <property name="workflowDefinitions">
            <list>
                <props>
                    <prop key="engineId">jbpm</prop>
                    <prop key="location">alfresco/workflow/publish_web_content_processdefinition.xml</prop>
                    <prop key="mimetype">text/xml</prop>
                    <prop key="redeploy">true</prop>
                </props>
            </list>
        </property>
        <property name="models">
            <list>
                <value>alfresco/workflow/publishingWorkflowModel.xml</value>
            </list>
        </property>
    </bean>

   <bean id="publishingResourceBundles" class="org.alfresco.i18n.ResourceBundleBootstrapComponent">
      <property name="resourceBundles">
         <list>
            <value>alfresco.messages.publishing-service</value>
         </list>
      </property>
   </bean>

   <!--  Channel Service -->
   <bean id="channelService" class="org.alfresco.repo.publishing.ChannelServiceImpl">
      <property name="dictionaryService" ref="DictionaryService" />
      <property name="nodeService" ref="NodeService" />
      <property name="siteService" ref="SiteService" />
      <property name="environmentHelper" ref="environmentHelper" />
      <property name="channelHelper" ref="channelHelper" />
   </bean>

   <!--  Channel Type Implementations -->
   <bean id="baseChannelType" class="org.alfresco.repo.publishing.AbstractChannelType" abstract="true" >
      <property name="channelService" ref="channelService" />
      <property name="serviceRegistry" ref="ServiceRegistry" />
   </bean>
   
   <bean id="channelHelper" class="org.alfresco.repo.publishing.ChannelHelper">
      <property name="nodeService" ref="NodeService" />
      <property name="dictionaryService" ref="DictionaryService" />
      <property name="fileFolderService" ref="FileFolderService" />
   </bean>

   <bean id="environmentHelper" class="org.alfresco.repo.publishing.EnvironmentHelper">
      <property name="nodeService" ref="NodeService" />
      <property name="siteService" ref="SiteService" />
      <property name="publishingEventHelper" ref="publishingEventHelper" />
      <property name="channelHelper" ref="channelHelper" />
   </bean>

   <bean id="publishingEventHelper" class="org.alfresco.repo.publishing.PublishingEventHelper">
      <property name="nodeService" ref="NodeService" />
      <property name="contentService" ref="ContentService" />
      <property name="serializer" ref="publishingPackageSerializer" />
      <property name="workflowService" ref="WorkflowService" />
      <property name="workflowEngineId" value="jbpm" />
   </bean>
        

   <!--  Publish Event Action -->
    <bean id="pub_publishEvent" class="org.alfresco.repo.publishing.PublishEventAction" >
      <property name="publishingEventProcessor" ref="publishingEventProcessor" />
   </bean>
   
   <!--  Publishing Event Processor -->
   <bean id="publishingEventProcessor" class="org.alfresco.repo.publishing.PublishingEventProcessor">
      <property name="channelHelper" ref="channelHelper" />
      <property name="channelService" ref="channelService" />
      <property name="publishingEventHelper" ref="publishingEventHelper" />
      <property name="nodeService" ref="NodeService" />
      <property name="behaviourFilter" ref="policyBehaviourFilter" />
   </bean>

   <bean id="publishingObjectFactory" class="org.alfresco.repo.publishing.PublishingObjectFactory">
      <property name="environmentHelper" ref="environmentHelper" />
      <property name="transferManifestNodeFactory" ref="transferManifestNodeFactory" />
      <property name="publishingEventHelper" ref="publishingEventHelper" />
      <property name="versionService" ref="VersionService" />
   </bean>
   
      <!--  Publishing Service -->
   <bean id="publishingService" class="org.alfresco.repo.publishing.PublishServiceImpl">
      <property name="environmentFactory" ref="publishingObjectFactory" />
      <property name="publishingEventHelper" ref="publishingEventHelper" />
   </bean>
   
   <bean id="publishingPackageSerializer" class="org.alfresco.repo.publishing.StandardPublishingPackageSerializer" />

</beans>
